import{j as e,o as y,C as F,a as P,P as D,D as $}from"./PlanViewer-pbnC21kX.js";import{r as p}from"./index-4g5l5LRQ.js";import"./v4-yQnnJER4.js";import"./_commonjsHelpers-4gQjN7DL.js";const h=({children:t,type:o="button"})=>e.jsx("button",{type:o,className:"govuk-button",children:t});try{h.displayName="Button",h.__docgenInfo={description:"",displayName:"Button",props:{type:{defaultValue:{value:"button"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"button"'},{value:'"submit"'},{value:'"reset"'}]}}}}}catch{}const _=({value:t,label:o,name:a,onChange:n})=>{const[s="",i=""]=t.split("-");return e.jsx("div",{className:"govuk-form-group",children:e.jsxs("fieldset",{className:"govuk-fieldset",role:"group","aria-describedby":`${a}-hint`,children:[e.jsx("legend",{className:"govuk-fieldset__legend",children:o}),e.jsx("div",{id:`${a}-hint`,className:"govuk-hint",children:"For example, 3 2007"}),e.jsxs("div",{className:"govuk-date-input",children:[e.jsx("div",{className:"govuk-date-input__item",children:e.jsxs("div",{className:"govuk-form-group",children:[e.jsx("label",{className:"govuk-label govuk-date-input__label",htmlFor:`${a}-month`,children:"Month"}),e.jsx("input",{id:`${a}-month`,"data-testid":`${a}-month`,className:"govuk-input govuk-date-input__input govuk-input--width-2",type:"text",inputMode:"numeric",value:i,onChange:c=>n(`${s}-${c.target.value}`),maxLength:2})]})}),e.jsx("div",{className:"govuk-date-input__item",children:e.jsxs("div",{className:"govuk-form-group",children:[e.jsx("label",{className:"govuk-label govuk-date-input__label",htmlFor:`${a}-year`,children:"Year"}),e.jsx("input",{id:`${a}-year`,"data-testid":`${a}-year`,className:"govuk-input govuk-date-input__inpaut govuk-input--width-4",type:"text",inputMode:"numeric",value:s,onChange:c=>n(`${c.target.value}-${i}`),maxLength:4})]})})]})]})})};try{_.displayName="DateInput",_.__docgenInfo={description:"",displayName:"DateInput",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}}}}}catch{}const b=({label:t,onChange:o,value:a})=>e.jsx("div",{className:"govuk-form-group",children:e.jsxs("label",{className:"govuk-label",children:[t,e.jsx("input",{className:"govuk-input",type:"text",value:a,onChange:n=>o(n.target.value)})]})});try{b.displayName="TextInput",b.__docgenInfo={description:"",displayName:"TextInput",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}}}}}catch{}const x=({label:t,onChange:o,accept:a=".csv"})=>{const n=s=>{s.target.files&&o(s.target.files[0])};return e.jsxs("div",{className:"govuk-form-group",children:[e.jsx("label",{className:"govuk-label",htmlFor:"file-upload",children:t}),e.jsx("input",{id:"file-upload",className:"govuk-file-upload",type:"file",accept:a,onChange:n})]})};try{x.displayName="FileUpload",x.__docgenInfo={description:"",displayName:"FileUpload",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: File) => void"}},accept:{defaultValue:{value:".csv"},description:"",name:"accept",required:!1,type:{name:"string"}}}}}catch{}const T="_form_1mguo_1",I={form:T},{timetableEvents:q,...w}=$,v=new FileReader,f=t=>{const{className:o,...a}=t,[n,s]=p.useState(w),[i,c]=p.useState(q),C=p.useMemo(()=>`data:text/csv;charset=urf-8, ${y(i)}`,[i]),V=p.useMemo(()=>`data:text/csv;charset=urf-8, ${y([n])}`,[n]),S=p.useCallback(l=>{v.onload=d=>{var r,m;const u=(m=(r=d.target)==null?void 0:r.result)==null?void 0:m.toString();u&&s(F(u))},v.readAsText(l)},[]),E=p.useCallback(l=>{v.onload=d=>{var r,m;const u=(m=(r=d.target)==null?void 0:r.result)==null?void 0:m.toString();u&&c(P(u))},v.readAsText(l)},[]);return e.jsxs("div",{className:`${o} ${I.form}`,...a,children:[e.jsx("h1",{className:"govuk-heading-xl","data-testid":"form-title",children:"Timetable Form"}),e.jsxs("div",{children:[e.jsx(x,{label:"Upload a CSV file for Development Plan",onChange:S}),e.jsx(x,{label:"Upload a CSV file for Timetable",onChange:E}),e.jsx(b,{label:"Local planning authority",onChange:l=>s(d=>({...d,organisations:l})),value:n.organisations})]}),i.map(l=>e.jsx("div",{children:e.jsx(_,{value:l.eventDate,label:l.developmentPlanEvent,name:`${l.developmentPlanEvent.split(" ").join("-")}-date`,onChange:d=>c(u=>u.map(r=>r===l?{...r,eventDate:d}:r))})},l.developmentPlanEvent)),e.jsx("div",{children:e.jsx("a",{role:"button",type:"button","data-testid":"csv-download-button",href:C,download:"timetable.csv",children:e.jsx(h,{children:"Export Timetable CSV"})})}),e.jsx("div",{children:e.jsx("a",{role:"button",type:"button","data-testid":"csv-download-header-button",href:V,download:"timetableHeader.csv",children:e.jsx(h,{children:"Export Timetable Header CSV"})})}),e.jsx("h1",{className:"govuk-heading-xl",children:"Preview"}),e.jsx(D,{plan:{...n,timetableEvents:i}})]})};try{f.displayName="Form",f.__docgenInfo={description:"",displayName:"Form",props:{}}}catch{}const B={title:"Example/Form",component:f,tags:["autodocs"],parameters:{layout:"fullscreen"}},g={};var j,N,k;g.parameters={...g.parameters,docs:{...(j=g.parameters)==null?void 0:j.docs,source:{originalSource:"{}",...(k=(N=g.parameters)==null?void 0:N.docs)==null?void 0:k.source}}};const H=["ExampleForm"];export{g as ExampleForm,H as __namedExportsOrder,B as default};
